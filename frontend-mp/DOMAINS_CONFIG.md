# 微信小程序域名配置指南

## 必要的域名配置

根据小程序的功能，需要在微信小程序后台配置以下域名：

### 1. request合法域名

已配置：`https://lovehome.xin`

用于API请求，如登录、获取数据等。

### 2. uploadFile合法域名（需添加）

需要添加：`https://lovehome.xin`

用于上传工单图片、议题附件等功能。

### 3. downloadFile合法域名（需添加）

需要添加：`https://lovehome.xin`

用于下载议题附件、查看通知附件等功能。

## 配置步骤

1. 登录微信公众平台 https://mp.weixin.qq.com/
2. 进入"开发"->"开发设置"->"服务器域名"
3. 在对应的域名输入框中添加以上域名
4. 点击"保存"按钮

## 注意事项

1. 域名必须使用HTTPS协议
2. 域名不能使用IP地址
3. 域名必须经过ICP备案
4. 不能配置端口号（如果配置了端口号，请求时必须使用相同的端口号）
5. 小程序开发环境可以临时关闭域名校验，但上线前必须完成域名配置

## 域名配置验证

1. 在开发者工具中，关闭"不校验合法域名"选项
2. 测试以下功能，确保正常工作：
   - 工单创建（上传图片功能）
   - 议题创建（上传附件功能）
   - 议题详情（下载附件功能）
   - 通知详情（下载附件功能）
   - 财务报告（下载报告功能）

## 常见问题

### 域名校验失败

如果遇到"request:fail invalid domain"错误，请检查：
1. 域名是否已正确配置
2. 域名是否使用HTTPS协议
3. 请求URL是否与配置的域名完全匹配（注意不要带端口号）

### 文件上传/下载失败

如果遇到"uploadFile:fail invalid domain"或"downloadFile:fail invalid domain"错误，请确保已添加对应的合法域名。

## 重要提示

微信小程序域名校验是强制性的，必须正确配置才能确保小程序正常运行。在提交审核前，请务必完成所有域名配置并验证功能正常。 